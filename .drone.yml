kind: pipeline
type: docker
name: gateway-tests

trigger:
  branch:
    - main
    - add-drone

pipeline:
  publish-image:
    image: plugins/docker
    dockerfile: ./Dockerfile
    context: .
    repo: gravityhuborg/gateway-tests
    tags: [latest,"${DRONE_BRANCH}"]
    secrets: [docker_username,docker_password]

  test-waves:
    image: gravityhuborg/gateway-tests:$DRONE_BRANCH
    commands:
    - make waves

  test-eth:
    image: gravityhuborg/gateway-tests:$DRONE_BRANCH
    commands:
    - make ethereum
